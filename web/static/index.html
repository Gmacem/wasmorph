<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wasmorph - Demo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/go/go.min.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; background: #f8f9fa; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: white; padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .nav { display: flex; justify-content: space-between; align-items: center; }
        .nav a { color: #007bff; text-decoration: none; margin-left: 20px; padding: 8px 16px; border-radius: 4px; }
        .nav a:hover { background: #f8f9fa; }
        .btn { background: #007bff; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; text-decoration: none; display: inline-block; }
        .btn:hover { background: #0056b3; }
        .btn-danger { background: #dc3545; }
        .btn-danger:hover { background: #c82333; }
        .btn-success { background: #28a745; }
        .btn-success:hover { background: #218838; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; }
        .form-control { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; }
        .form-control:focus { outline: none; border-color: #007bff; box-shadow: 0 0 0 2px rgba(0,123,255,0.25); }
        .card { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .error { background: #f8d7da; color: #721c24; padding: 12px; border-radius: 6px; margin-bottom: 20px; }
        .code { background: #f8f9fa; padding: 20px; border-radius: 6px; font-family: 'Monaco', 'Menlo', monospace; font-size: 14px; overflow-x: auto; }
        .grid { display: grid; gap: 20px; }
        .flex { display: flex; gap: 10px; align-items: center; }
        
        /* CodeMirror customization */
        .CodeMirror {
            border: 1px solid #ddd;
            border-radius: 6px;
            min-height: 400px;
            font-size: 14px;
        }
        
        .CodeMirror:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }
        
        /* Syntax highlighting for Go */
        .go-keyword { color: #569cd6; }
        .go-string { color: #ce9178; }
        .go-comment { color: #6a9955; }
        .go-function { color: #dcdcaa; }
        .go-type { color: #4ec9b0; }
        .go-number { color: #b5cea8; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="nav">
                <h1 style="margin: 0; font-size: 24px;">Wasmorph</h1>
                <div>
                    <span>Welcome, admin</span>
                    <a href="#scripts">My Scripts</a>
                    <a href="#logout">Logout</a>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <div>
                    <h2 style="margin: 0 0 5px 0; font-size: 28px;">My Scripts</h2>
                    <p style="color: #666; margin: 0;">Manage your Go scripts</p>
                </div>
                <button onclick="openEditor()" class="btn">Create New Script</button>
            </div>
            
            <div style="text-align: center; padding: 60px 20px;">
                <p style="color: #666; font-size: 18px;">No scripts found. Create your first script!</p>
            </div>
        </div>
    </div>

    <div id="executeModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 1000;">
        <div style="background: white; border-radius: 8px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
            <div style="padding: 20px; border-bottom: 1px solid #ddd;">
                <h3 style="margin: 0; font-size: 20px;">Execute Script</h3>
            </div>
            <div style="padding: 20px;">
                <div class="form-group">
                    <label for="inputData">Input JSON</label>
                    <textarea id="inputData" rows="4" class="form-control code" placeholder='{"input": "test"}'></textarea>
                </div>
                <div style="display: flex; justify-content: flex-end; gap: 10px;">
                    <button onclick="closeModal()" class="btn" style="background: #6c757d;">Cancel</button>
                    <button onclick="confirmExecute()" class="btn">Execute</button>
                </div>
            </div>
        </div>
    </div>

    <div id="editorModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 1000;">
        <div style="background: white; border-radius: 8px; max-width: 800px; width: 95%; max-height: 90vh; overflow-y: auto;">
            <div style="padding: 20px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center;">
                <h3 style="margin: 0; font-size: 20px;">Go Script Editor</h3>
                <button onclick="closeEditor()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">Ã—</button>
            </div>
            <div style="padding: 20px;">
                <div class="form-group">
                    <label for="scriptName">Script Name</label>
                    <input type="text" id="scriptName" class="form-control" placeholder="my-awesome-script">
                </div>
                <div class="form-group">
                    <label for="scriptCode">Go Code</label>
                    <textarea id="scriptCode" placeholder="package main

import (
    &quot;encoding/json&quot;
    &quot;fmt&quot;
)

func main() {
    result := map[string]interface{}{
        &quot;message&quot;: &quot;Hello from WASM!&quot;,
    }
    
    jsonData, _ := json.Marshal(result)
    fmt.Print(string(jsonData))
}"></textarea>
                </div>
                <div style="display: flex; justify-content: flex-end; gap: 10px;">
                    <button onclick="closeEditor()" class="btn" style="background: #6c757d;">Cancel</button>
                    <button onclick="saveScript()" class="btn">Save Script</button>
                </div>
            </div>
        </div>
    </div>

    <script>
    let currentScriptName = '';

    let codeEditor = null;

    function openEditor() {
        document.getElementById('editorModal').style.display = 'flex';
        document.getElementById('scriptName').value = '';
        
        // Initialize CodeMirror if not already done
        if (!codeEditor) {
            const textarea = document.getElementById('scriptCode');
            codeEditor = CodeMirror.fromTextArea(textarea, {
                mode: 'go',
                theme: 'monokai',
                lineNumbers: true,
                indentUnit: 4,
                tabSize: 4,
                lineWrapping: true,
                autoCloseBrackets: true,
                matchBrackets: true,
                foldGutter: true,
                gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'],
                keyMap: "default"
            });
            
        } else {
            codeEditor.setValue('');
        }
    }

    function closeEditor() {
        document.getElementById('editorModal').style.display = 'none';
    }

    function saveScript() {
        const name = document.getElementById('scriptName').value;
        const code = codeEditor ? codeEditor.getValue() : document.getElementById('scriptCode').value;
        
        if (!name || !code) {
            alert('Please fill in both script name and code');
            return;
        }
        
        // Mock save for demo
        alert(`Script "${name}" saved (mock)`);
        closeEditor();
    }

    function executeScript(name) {
        currentScriptName = name;
        document.getElementById('executeModal').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('executeModal').style.display = 'none';
        currentScriptName = '';
    }

    function confirmExecute() {
        const inputData = document.getElementById('inputData').value;
        
        // Mock execution for demo
        const mockResult = {
            result: "Mock execution result",
            input: JSON.parse(inputData || '{}'),
            timestamp: new Date().toISOString()
        };
        alert('Result: ' + JSON.stringify(mockResult, null, 2));
        closeModal();
    }

    function deleteScript(name) {
        if (confirm('Are you sure you want to delete this script?')) {
            // Mock deletion for demo
            alert(`Script "${name}" deleted (mock)`);
            location.reload();
        }
    }
    </script>
</body>
</html>
